---
title: Blog 1
author: Peimin Lin
date: '2020-08-28'
slug: blog-1
categories: []
tags: []
subtitle: ''
summary: ''
authors: []
lastmod: '2020-09-02T19:27:06+10:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  echo = FALSE, 
  message = FALSE,
  warning = FALSE, 
  fig.align = "center")
library(tibble)
library(timevis)
library(tidyverse)
library(broom)
library(lubridate)
library(zoo)
library(coronavirus)
library(widgetframe)
library(formattable)
library(bookdown)
```

```{r read_data}
case <- read_csv("COVID19BE_CASES_AGESEX.csv")
mort <- read_csv("COVID19BE_MORT.csv")
data("coronavirus")
```

The blog is a research about coronavirus(COVID-19) in Belgium from March 2020 to August 2020 and used the data source from [Kaggle]( https://www.kaggle.com/evgeniako/covid19-in-belgium) and used  the dataset from package *coronavirus*. 

You can visualise the number of COVID-19 cased confirmed in Belgium from March to August 2020 in Figure \@ref(fig:active). It shows that April was the most seriousness month that have the largest infected population. Since then, people started pay attention and took anti-epidemic action and the confirmed cases got a good result. However, there are still have high number of confirmed cases. 

```{r case_tidy}
tidy_case <- case %>% mutate(MONTH = month(DATE),
                             YEAR = year(DATE)) %>% 
 count(MONTH,YEAR, name = "NUMBER")%>%
  drop_na( MONTH) 
```

```{r tibble}
tibble <- within(tidy_case, Date <- sprintf("%d-%02d", YEAR, MONTH)) %>% mutate(start = Date, end = NA)
```

```{r active, fig.cap = "Cases confrimed in Belgium since March 2020"}
active <- tibble %>%
  dplyr::select( NUMBER, start, end) %>% 
  rename(content = NUMBER)
timevis(active, showZoom = FALSE, height = "150px")
   
```

For further research, it found that the elder got higher infected rate, Figure \@ref(fig:compare) listed confirmed cases in difference provinces and regions and difference age group. It shows that the largest number were from 80-89 age group in every region in April. 


```{r format}
format <- case %>% 
  mutate(MONTH = month(DATE)) %>%
 count(MONTH,REGION,PROVINCE, AGEGROUP,name = "NUMBER") %>%
  drop_na(PROVINCE, REGION,AGEGROUP)%>% 
  arrange(desc(NUMBER)) %>%
  head(10)
```

```{r compare, fig.cap="the hardest time in Belgium"}
compare <- format %>% 
  as.data.frame() %>%
rownames_to_column("Variables") %>%
formattable(list(area(col = 5:6) ~ color_tile("#F5B7B1", "#7DCEA0")))
compare
```

We found that not only did the elder would easier infected, but also got a higher death rate. In Figure \@ref(fig:facet-1), it shows that number of mortality in three regions in Belgium, all the age group people in the lists and especially in the elder group. Brussels is the least number of mortality among the data set. 


```{r mort}
tidy_mort <- mort %>% mutate(MONTH = month(DATE)) %>% 
 count(MONTH,REGION, AGEGROUP,name = "NUMBER") %>%
  drop_na(AGEGROUP)
```

```{r facet, out.height = "80%"}
death <- ggplot(tidy_mort,
       aes(x= MONTH, y = NUMBER, fill = REGION)) +
  geom_col(position = "dodge") +
  facet_wrap(REGION~AGEGROUP,nrow = 3)
death
```

```{r second}
second <- coronavirus %>% 
  filter(date>= "2020-03-01") %>%
  dplyr::select(country, type, cases, date) %>%
  mutate(month = month(date))%>%
  group_by(country, type, month) %>%
  summarise(total_cases = sum(cases)) %>%
  pivot_wider(names_from = type,
              values_from = total_cases)%>%
  mutate(death_rate = death/confirmed*100,
         recovered_rate = recovered/confirmed*100)%>%
  mutate_if(is.numeric, round, digits = 2) %>%
  filter(country %in% c("US","China","Belgium"))
```

Compare with United State and China which are the country got serious epidemic, we calculate the death rate and recovery rate. The interactive table shows below that Belgium got the second highest death rate in April.

```{r dt}
frameWidget(DT::datatable(second, options = list(pageLength = 5)))
```


